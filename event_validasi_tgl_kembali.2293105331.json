{
	"type": "EVENT_FIELD",
	"name": "validasi_tgl_kembali",
	"serverCode": "$_SESSION[\"tglPeriksa\"] = $params[\"tglPeriksa\"];\n$_SESSION[\"tglKembali\"] = $params[\"tglKembali\"];",
	"beforeJsCode": "try {\r\n    // Ambil field elements\r\n    var field_tgl_periksa = document.querySelector('[id*=\"value_tgl_periksa\"]');\r\n    var field_tgl_kembali = document.querySelector('[id*=\"value_tgl_kembali\"]');\r\n    \r\n    var tgl_periksa = field_tgl_periksa ? field_tgl_periksa.value : '';\r\n    var tgl_kembali = field_tgl_kembali ? field_tgl_kembali.value : '';\r\n    \r\n    // Validasi kosong\r\n    if (!tgl_periksa || !tgl_kembali) {\r\n        alert('‚ö†Ô∏è Tanggal periksa dan tanggal kembali harus diisi!');\r\n        return false;\r\n    }\r\n    \r\n    // Parse tanggal\r\n    var partsPeriksa = tgl_periksa.split('/');\r\n    var partsKembali = tgl_kembali.split('/');\r\n    \r\n    if (partsPeriksa.length !== 3 || partsKembali.length !== 3) {\r\n        alert('‚ö†Ô∏è Format tanggal tidak valid! Gunakan format DD/MM/YYYY');\r\n        return false;\r\n    }\r\n    \r\n    // Buat Date object\r\n    var datePeriksa = new Date(partsPeriksa[2], partsPeriksa[1] - 1, partsPeriksa[0]);\r\n    var dateKembali = new Date(partsKembali[2], partsKembali[1] - 1, partsKembali[0]);\r\n    \r\n    params[\"tglPeriksa\"] = datePeriksa;\r\n    params[\"tglKembali\"] = dateKembali;\r\n    \r\n    // Reset time untuk compare date only\r\n    datePeriksa.setHours(0, 0, 0, 0);\r\n    dateKembali.setHours(0, 0, 0, 0);\r\n    \r\n    // Validasi\r\n    if (dateKembali < datePeriksa) {\r\n        // Remove error style dari field sebelumnya\r\n        if (field_tgl_periksa) {\r\n            field_tgl_periksa.style.borderColor = '';\r\n            field_tgl_periksa.style.boxShadow = '';\r\n        }\r\n        \r\n        // Kosongkan dan highlight field tgl_kembali\r\n        if (field_tgl_kembali) {\r\n            field_tgl_kembali.value = '';\r\n            field_tgl_kembali.style.borderColor = '#dc3545';\r\n            field_tgl_kembali.style.boxShadow = '0 0 0 0.2rem rgba(220, 53, 69, 0.25)';\r\n        }\r\n        \r\n        // Tampilkan alert dengan informasi jelas\r\n        alert('‚ùå VALIDASI GAGAL\\n\\n' +\r\n              'Tanggal kembali tidak boleh kurang dari tanggal periksa!\\n\\n' +\r\n              'üìÖ Tanggal Periksa: ' + tgl_periksa + '\\n' +\r\n              'üìÖ Tanggal Kembali: ' + tgl_kembali + '\\n' +\r\n              'Silakan isi ulang Tanggal Kembali yang benar!');\r\n        \r\n        // Set focus ke field tgl_kembali\r\n        if (field_tgl_kembali) {\r\n            field_tgl_kembali.focus();\r\n        }\r\n        \r\n        return false;\r\n    }\r\n    \r\n    // Remove error style jika valid\r\n    if (field_tgl_kembali) {\r\n        field_tgl_kembali.style.borderColor = '';\r\n        field_tgl_kembali.style.boxShadow = '';\r\n    }\r\n    \r\n    return true;\r\n    \r\n} catch (e) {\r\n    console.error('Validasi tanggal error:', e);\r\n    \r\n    // Reset field jika error\r\n    var field_tgl_kembali = document.querySelector('[id*=\"value_tgl_kembali\"]');\r\n    if (field_tgl_kembali) {\r\n        field_tgl_kembali.value = '';\r\n        field_tgl_kembali.style.borderColor = '#dc3545';\r\n    }\r\n    \r\n    alert('‚ùå Error: ' + e.message + '\\n\\nField tanggal kembali dikosongkan.');\r\n    return false;\r\n}",
	"afterJsCode": "\n\n// Sample:\n//ctrl.setValue( result[\"upper\"] );\n"
}